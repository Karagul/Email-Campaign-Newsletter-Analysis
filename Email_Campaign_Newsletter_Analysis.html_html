<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="data:text/css;charset=utf-8,%0A%40font%2Dface%20%7B%0Afont%2Dfamily%3A%20octicons%2Dlink%3B%0Asrc%3A%20url%28data%3Afont%2Fwoff%3Bcharset%3Dutf%2D8%3Bbase64%2Cd09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM%2B8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB%2FaFGpk3jaTY6xa8JAGMW%2FO62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v%2Bk%2F0an2i%2BitHDw3v2%2B9%2BDBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3%2FI7AtxEJLtzzuZfI%2BVVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy%2FLt7Kc%2B0vWY%2FgAgIIEqAN9we0pwKXreiMasxvabDQMM4riO%2BqxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw%2Bymhce7vwM9jSqO8JyVd5RH9gyTt2%2BJ%2FyUmYlIR0s04n6%2B7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv%2FocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi%2BW2%2BMjCzMIDApSwvXzC97Z4Ig8N%2FBxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh%2F8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT%2BAEjAwuDFpBmA9KMDEwMCh9i%2Fv8H8sH0%2F4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9%2FlqYwOGZxeUelN2U2R6%2BcArgtCJpauW7UQBqnFkUsjAY%2FkOU1cP%2BDAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl%2BvvmM%2FbyA48e6tWrKArm4ZJlCbdsrxksL1AwWn%2FyBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO%2F%2FsdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd%2F89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF%2B9JOS0nbaaYDCQfwCJ7Au3AHj%2BLO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm%2BEBXuAbHmIMSRMs%2B4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL%2BhD7C1xoaHeLJSEao0FEW14ckxC%2BTU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13%2F%2Blm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl%2B9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O%2FAdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB%2F%2F%2FAA8AAQAAAAAAAAAAAAAAAAABAAAAAA%3D%3D%29%20format%28%27woff%27%29%3B%0A%7D%0Abody%20%7B%0A%2Dwebkit%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%0Atext%2Dsize%2Dadjust%3A%20100%25%3B%0Acolor%3A%20%23333%3B%0Afont%2Dfamily%3A%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20%22Segoe%20UI%22%2C%20Arial%2C%20freesans%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0Afont%2Dsize%3A%2016px%3B%0Aline%2Dheight%3A%201%2E6%3B%0Aword%2Dwrap%3A%20break%2Dword%3B%0A%7D%0Aa%20%7B%0Abackground%2Dcolor%3A%20transparent%3B%0A%7D%0Aa%3Aactive%2C%0Aa%3Ahover%20%7B%0Aoutline%3A%200%3B%0A%7D%0Astrong%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%202em%3B%0Amargin%3A%200%2E67em%200%3B%0A%7D%0Aimg%20%7B%0Aborder%3A%200%3B%0A%7D%0Ahr%20%7B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Aheight%3A%200%3B%0A%7D%0Apre%20%7B%0Aoverflow%3A%20auto%3B%0A%7D%0Acode%2C%0Akbd%2C%0Apre%20%7B%0Afont%2Dfamily%3A%20monospace%2C%20monospace%3B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ainput%20%7B%0Acolor%3A%20inherit%3B%0Afont%3A%20inherit%3B%0Amargin%3A%200%3B%0A%7D%0Ahtml%20input%5Bdisabled%5D%20%7B%0Acursor%3A%20default%3B%0A%7D%0Ainput%20%7B%0Aline%2Dheight%3A%20normal%3B%0A%7D%0Ainput%5Btype%3D%22checkbox%22%5D%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0Apadding%3A%200%3B%0A%7D%0Atable%20%7B%0Aborder%2Dcollapse%3A%20collapse%3B%0Aborder%2Dspacing%3A%200%3B%0A%7D%0Atd%2C%0Ath%20%7B%0Apadding%3A%200%3B%0A%7D%0A%2A%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0A%7D%0Ainput%20%7B%0Afont%3A%2013px%20%2F%201%2E4%20Helvetica%2C%20arial%2C%20nimbussansl%2C%20liberationsans%2C%20freesans%2C%20clean%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%234078c0%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%2C%0Aa%3Aactive%20%7B%0Atext%2Ddecoration%3A%20underline%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%200%3B%0Amargin%3A%2015px%200%3B%0Aoverflow%3A%20hidden%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23ddd%3B%0A%7D%0Ahr%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ahr%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%2015px%3B%0Amargin%2Dbottom%3A%2015px%3B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%2030px%3B%0A%7D%0Ah2%20%7B%0Afont%2Dsize%3A%2021px%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%2016px%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%2014px%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%2011px%3B%0A%7D%0Ablockquote%20%7B%0Amargin%3A%200%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Aol%20ol%2C%0Aul%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Droman%3B%0A%7D%0Aul%20ul%20ol%2C%0Aul%20ol%20ol%2C%0Aol%20ul%20ol%2C%0Aol%20ol%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Dalpha%3B%0A%7D%0Add%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0Afont%3A%2012px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0A%7D%0A%2Eselect%3A%3A%2Dms%2Dexpand%20%7B%0Aopacity%3A%200%3B%0A%7D%0A%2Eocticon%20%7B%0Afont%3A%20normal%20normal%20normal%2016px%2F1%20octicons%2Dlink%3B%0Adisplay%3A%20inline%2Dblock%3B%0Atext%2Ddecoration%3A%20none%3B%0Atext%2Drendering%3A%20auto%3B%0A%2Dwebkit%2Dfont%2Dsmoothing%3A%20antialiased%3B%0A%2Dmoz%2Dosx%2Dfont%2Dsmoothing%3A%20grayscale%3B%0A%2Dwebkit%2Duser%2Dselect%3A%20none%3B%0A%2Dmoz%2Duser%2Dselect%3A%20none%3B%0A%2Dms%2Duser%2Dselect%3A%20none%3B%0Auser%2Dselect%3A%20none%3B%0A%7D%0A%2Eocticon%2Dlink%3Abefore%20%7B%0Acontent%3A%20%27%5Cf05c%27%3B%0A%7D%0A%2Emarkdown%2Dbody%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%20%21important%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%20%21important%3B%0A%7D%0Aa%3Anot%28%5Bhref%5D%29%20%7B%0Acolor%3A%20inherit%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0A%2Eanchor%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%2Dright%3A%202px%3B%0Amargin%2Dleft%3A%20%2D18px%3B%0A%7D%0A%2Eanchor%3Afocus%20%7B%0Aoutline%3A%20none%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%201em%3B%0Amargin%2Dbottom%3A%2016px%3B%0Afont%2Dweight%3A%20bold%3B%0Aline%2Dheight%3A%201%2E4%3B%0A%7D%0Ah1%20%2Eocticon%2Dlink%2C%0Ah2%20%2Eocticon%2Dlink%2C%0Ah3%20%2Eocticon%2Dlink%2C%0Ah4%20%2Eocticon%2Dlink%2C%0Ah5%20%2Eocticon%2Dlink%2C%0Ah6%20%2Eocticon%2Dlink%20%7B%0Acolor%3A%20%23000%3B%0Avertical%2Dalign%3A%20middle%3B%0Avisibility%3A%20hidden%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%2C%0Ah2%3Ahover%20%2Eanchor%2C%0Ah3%3Ahover%20%2Eanchor%2C%0Ah4%3Ahover%20%2Eanchor%2C%0Ah5%3Ahover%20%2Eanchor%2C%0Ah6%3Ahover%20%2Eanchor%20%7B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah2%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah3%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah4%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah5%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah6%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%20%7B%0Avisibility%3A%20visible%3B%0A%7D%0Ah1%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%202%2E25em%3B%0Aline%2Dheight%3A%201%2E2%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah1%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah2%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%201%2E75em%3B%0Aline%2Dheight%3A%201%2E225%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah2%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%201%2E5em%3B%0Aline%2Dheight%3A%201%2E43%3B%0A%7D%0Ah3%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%201%2E25em%3B%0A%7D%0Ah4%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ah5%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%201em%3B%0Acolor%3A%20%23777%3B%0A%7D%0Ah6%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ap%2C%0Ablockquote%2C%0Aul%2C%0Aol%2C%0Adl%2C%0Atable%2C%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%204px%3B%0Apadding%3A%200%3B%0Amargin%3A%2016px%200%3B%0Abackground%2Dcolor%3A%20%23e7e7e7%3B%0Aborder%3A%200%20none%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%2Dleft%3A%202em%3B%0A%7D%0Aul%20ul%2C%0Aul%20ol%2C%0Aol%20ol%2C%0Aol%20ul%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Ali%3Ep%20%7B%0Amargin%2Dtop%3A%2016px%3B%0A%7D%0Adl%20%7B%0Apadding%3A%200%3B%0A%7D%0Adl%20dt%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%2016px%3B%0Afont%2Dsize%3A%201em%3B%0Afont%2Dstyle%3A%20italic%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Adl%20dd%20%7B%0Apadding%3A%200%2016px%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ablockquote%20%7B%0Apadding%3A%200%2015px%3B%0Acolor%3A%20%23777%3B%0Aborder%2Dleft%3A%204px%20solid%20%23ddd%3B%0A%7D%0Ablockquote%3E%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Ablockquote%3E%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Atable%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%20100%25%3B%0Aoverflow%3A%20auto%3B%0Aword%2Dbreak%3A%20normal%3B%0Aword%2Dbreak%3A%20keep%2Dall%3B%0A%7D%0Atable%20th%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Atable%20th%2C%0Atable%20td%20%7B%0Apadding%3A%206px%2013px%3B%0Aborder%3A%201px%20solid%20%23ddd%3B%0A%7D%0Atable%20tr%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Aborder%2Dtop%3A%201px%20solid%20%23ccc%3B%0A%7D%0Atable%20tr%3Anth%2Dchild%282n%29%20%7B%0Abackground%2Dcolor%3A%20%23f8f8f8%3B%0A%7D%0Aimg%20%7B%0Amax%2Dwidth%3A%20100%25%3B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Abackground%2Dcolor%3A%20%23fff%3B%0A%7D%0Acode%20%7B%0Apadding%3A%200%3B%0Apadding%2Dtop%3A%200%2E2em%3B%0Apadding%2Dbottom%3A%200%2E2em%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%2085%25%3B%0Abackground%2Dcolor%3A%20rgba%280%2C0%2C0%2C0%2E04%29%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0Acode%3Abefore%2C%0Acode%3Aafter%20%7B%0Aletter%2Dspacing%3A%20%2D0%2E2em%3B%0Acontent%3A%20%22%5C00a0%22%3B%0A%7D%0Apre%3Ecode%20%7B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%20100%25%3B%0Aword%2Dbreak%3A%20normal%3B%0Awhite%2Dspace%3A%20pre%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0A%2Ehighlight%20%7B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0A%2Ehighlight%20pre%2C%0Apre%20%7B%0Apadding%3A%2016px%3B%0Aoverflow%3A%20auto%3B%0Afont%2Dsize%3A%2085%25%3B%0Aline%2Dheight%3A%201%2E45%3B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0A%2Ehighlight%20pre%20%7B%0Amargin%2Dbottom%3A%200%3B%0Aword%2Dbreak%3A%20normal%3B%0A%7D%0Apre%20%7B%0Aword%2Dwrap%3A%20normal%3B%0A%7D%0Apre%20code%20%7B%0Adisplay%3A%20inline%3B%0Amax%2Dwidth%3A%20initial%3B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Aoverflow%3A%20initial%3B%0Aline%2Dheight%3A%20inherit%3B%0Aword%2Dwrap%3A%20normal%3B%0Abackground%2Dcolor%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0Apre%20code%3Abefore%2C%0Apre%20code%3Aafter%20%7B%0Acontent%3A%20normal%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%2Dsize%3A%2011px%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Epl%2Dc%20%7B%0Acolor%3A%20%23969896%3B%0A%7D%0A%2Epl%2Dc1%2C%0A%2Epl%2Ds%20%2Epl%2Dv%20%7B%0Acolor%3A%20%230086b3%3B%0A%7D%0A%2Epl%2De%2C%0A%2Epl%2Den%20%7B%0Acolor%3A%20%23795da3%3B%0A%7D%0A%2Epl%2Ds%20%2Epl%2Ds1%2C%0A%2Epl%2Dsmi%20%7B%0Acolor%3A%20%23333%3B%0A%7D%0A%2Epl%2Dent%20%7B%0Acolor%3A%20%2363a35c%3B%0A%7D%0A%2Epl%2Dk%20%7B%0Acolor%3A%20%23a71d5d%3B%0A%7D%0A%2Epl%2Dpds%2C%0A%2Epl%2Ds%2C%0A%2Epl%2Ds%20%2Epl%2Dpse%20%2Epl%2Ds1%2C%0A%2Epl%2Dsr%2C%0A%2Epl%2Dsr%20%2Epl%2Dcce%2C%0A%2Epl%2Dsr%20%2Epl%2Dsra%2C%0A%2Epl%2Dsr%20%2Epl%2Dsre%20%7B%0Acolor%3A%20%23183691%3B%0A%7D%0A%2Epl%2Dv%20%7B%0Acolor%3A%20%23ed6a43%3B%0A%7D%0A%2Epl%2Did%20%7B%0Acolor%3A%20%23b52a1d%3B%0A%7D%0A%2Epl%2Dii%20%7B%0Abackground%2Dcolor%3A%20%23b52a1d%3B%0Acolor%3A%20%23f8f8f8%3B%0A%7D%0A%2Epl%2Dsr%20%2Epl%2Dcce%20%7B%0Acolor%3A%20%2363a35c%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dml%20%7B%0Acolor%3A%20%23693a17%3B%0A%7D%0A%2Epl%2Dmh%2C%0A%2Epl%2Dmh%20%2Epl%2Den%2C%0A%2Epl%2Dms%20%7B%0Acolor%3A%20%231d3e81%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmq%20%7B%0Acolor%3A%20%23008080%3B%0A%7D%0A%2Epl%2Dmi%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dstyle%3A%20italic%3B%0A%7D%0A%2Epl%2Dmb%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmd%20%7B%0Abackground%2Dcolor%3A%20%23ffecec%3B%0Acolor%3A%20%23bd2c00%3B%0A%7D%0A%2Epl%2Dmi1%20%7B%0Abackground%2Dcolor%3A%20%23eaffea%3B%0Acolor%3A%20%2355a532%3B%0A%7D%0A%2Epl%2Dmdr%20%7B%0Acolor%3A%20%23795da3%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmo%20%7B%0Acolor%3A%20%231d3e81%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%3A%2011px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20%7B%0Alist%2Dstyle%2Dtype%3A%20none%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%2B%2Etask%2Dlist%2Ditem%20%7B%0Amargin%2Dtop%3A%203px%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20input%20%7B%0Amargin%3A%200%200%2E35em%200%2E25em%20%2D1%2E6em%3B%0Avertical%2Dalign%3A%20middle%3B%0A%7D%0A%3Achecked%2B%2Eradio%2Dlabel%20%7B%0Az%2Dindex%3A%201%3B%0Aposition%3A%20relative%3B%0Aborder%2Dcolor%3A%20%234078c0%3B%0A%7D%0Acode%20%3E%20%2Ekw%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%3E%20%2Edt%20%7B%20color%3A%20%23ed6a43%3B%20%7D%0Acode%20%3E%20%2Edv%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%3E%20%2Ebn%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%3E%20%2Efl%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%3E%20%2Ech%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%3E%20%2Est%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%3E%20%2Eco%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%3E%20%2Eot%20%7B%20color%3A%20%230086b3%3B%20%7D%0Acode%20%3E%20%2Eal%20%7B%20color%3A%20%23a61717%3B%20%7D%0Acode%20%3E%20%2Efu%20%7B%20color%3A%20%2363a35c%3B%20%7D%0Acode%20%3E%20%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%0Acode%20%3E%20%2Ewa%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%3E%20%2Ecn%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%3E%20%2Esc%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%3E%20%2Evs%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%3E%20%2Ess%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%3E%20%2Eim%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%3E%20%2Eva%20%7Bcolor%3A%20%23008080%3B%20%7D%0Acode%20%3E%20%2Ecf%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%3E%20%2Eop%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%3E%20%2Ebu%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%3E%20%2Eex%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%3E%20%2Epp%20%7B%20color%3A%20%23999999%3B%20%7D%0Acode%20%3E%20%2Eat%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%3E%20%2Edo%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%3E%20%2Ean%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%3E%20%2Ecv%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%3E%20%2Ein%20%7B%20color%3A%20%23008080%3B%20%7D%0A" rel="stylesheet">
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>

</head>

<body>

<h1 id="email-campaign-newsletter-analysis">Email Campaign Newsletter Analysis</h1>
<p>Niket Choudhary<br />
July 12, 2018</p>
<p>Email Campaign Newsletter</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">subdata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="kw">file.choose</span>(), <span class="dt">header =</span> T, <span class="dt">na.strings =</span> <span class="kw">c</span>(<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot; &quot;</span>,<span class="st">&quot;.&quot;</span>)) <span class="co"># choose the subscribers data csv file</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(subdata)</code></pre></div>
<pre><code>## [1] 705144</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ncol</span>(subdata)</code></pre></div>
<pre><code>## [1] 21</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(subdata)</code></pre></div>
<pre><code>##                 Profile.Id        Domain Engagement              Signup
## 1 5572fb5592721912198b587b sbcglobal.net hardbounce 2015/06/06 09:53:25
## 2 5441111b66dfa5ab01b0a000   hotmail.com     optout 2014/10/17 08:52:43
## 3 56cde9d9d9cb94486d8b51d7     yahoo.com     optout 2016/02/24 12:35:21
## 4 57e68298d9cb942a708b48db     gmail.com    dormant 2016/09/24 09:41:44
## 5 5498bd77f641910f100e23fb sbcglobal.net     optout 2014/12/22 19:55:19
## 6 57f84fbad9cb94f1778b50d7   hotmail.com    passive 2016/10/07 21:45:30
##   Opens Clicks           Last.Open          Last.Click         Optout.Time
## 1    51     11 2016/01/20 00:35:25 2015/08/12 19:50:19                &lt;NA&gt;
## 2     2      0 2014/11/21 07:37:15                &lt;NA&gt; 2014/11/21 07:45:29
## 3     0      0                &lt;NA&gt;                &lt;NA&gt; 2016/03/02 19:45:14
## 4     0      0                &lt;NA&gt;                &lt;NA&gt;                &lt;NA&gt;
## 5    30      1 2015/01/06 21:10:26 2015/01/01 21:21:20 2015/01/06 21:11:33
## 6    54     29 2017/04/17 15:29:19 2017/04/06 10:34:26                &lt;NA&gt;
##         Geolocation.City Geolocation.State Geolocation.Country
## 1 El Dorado Hills, CA US             CA US                  US
## 2                   &lt;NA&gt;              &lt;NA&gt;                &lt;NA&gt;
## 3                   &lt;NA&gt;              &lt;NA&gt;                &lt;NA&gt;
## 4                   &lt;NA&gt;              &lt;NA&gt;                &lt;NA&gt;
## 5                   &lt;NA&gt;              &lt;NA&gt;                  US
## 6      Birmingham, MI US             MI US                  US
##   Geolocation.Zip Lifetime.Message Top.Device referral_source first_name
## 1        95762 US              169      Other             DMi      Betty
## 2            &lt;NA&gt;              203       &lt;NA&gt;        Untagged       &lt;NA&gt;
## 3            &lt;NA&gt;               10       &lt;NA&gt;             DMi        Ana
## 4            &lt;NA&gt;              257       &lt;NA&gt;        Facebook       &lt;NA&gt;
## 5            &lt;NA&gt;               39    Android            &lt;NA&gt;       &lt;NA&gt;
## 6        48009 US              235     Chrome      In Book Ad       &lt;NA&gt;
##   last_name age gender
## 1   Goodwin  NA   &lt;NA&gt;
## 2      &lt;NA&gt;  NA   &lt;NA&gt;
## 3   Alvarez  NA   &lt;NA&gt;
## 4      &lt;NA&gt;  NA   &lt;NA&gt;
## 5      &lt;NA&gt;  NA   &lt;NA&gt;
## 6      &lt;NA&gt;  NA   &lt;NA&gt;
##                                                                                                                                                                       ebb_preferences
## 1                                                                  [&quot;bestsellers&quot;,&quot;mysteries_thrillers_true_crime&quot;,&quot;science_fiction_fantasy&quot;,&quot;literary_fiction&quot;,&quot;general_nonfiction&quot;]
## 2                                                                                                                                                                                &lt;NA&gt;
## 3                                                                                                                                                                                &lt;NA&gt;
## 4                                                                                                                                                   [&quot;bestsellers&quot;,&quot;book_club_picks&quot;]
## 5                                                                                                                                                                                &lt;NA&gt;
## 6 [&quot;historical_fiction&quot;,&quot;literary_fiction&quot;,&quot;mysteries_thrillers_true_crime&quot;,&quot;romance&quot;,&quot;young_adult&quot;,&quot;biographies_and_memoir&quot;,&quot;lifestyle_and_cooking&quot;,&quot;bestsellers&quot;,&quot;book_club_picks&quot;]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(subdata)</code></pre></div>
<pre><code>##                     Profile.Id             Domain      
##  539f4216a256ab65720001de:     1   gmail.com  :292168  
##  53a30c519dbcd4ed3800026a:     1   yahoo.com  :156392  
##  53b2bfdfa256ab243e0004e8:     1   aol.com    : 48256  
##  53b2c10ca256ab0f3e000685:     1   hotmail.com: 47714  
##  53b2fbbba256abf131000355:     1   comcast.net: 18395  
##  53b300c6fdd5ac595400042c:     1   (Other)    :142185  
##  (Other)                 :705138   NA's       :    34  
##       Engagement                     Signup           Opens         
##  disengaged:243353   2017/04/07 15:45:49:  1443   Min.   :    0.00  
##  optout    :186133   2016/07/06 08:47:15:  1428   1st Qu.:    1.00  
##  dormant   :122557   2017/02/27 15:56:39:  1092   Median :    8.00  
##  passive   : 90974   2017/02/06 16:08:53:  1046   Mean   :   78.71  
##  active    : 32083   2017/02/23 15:29:05:   995   3rd Qu.:   52.00  
##  hardbounce: 27530   2017/04/18 07:49:56:   945   Max.   :48198.00  
##  (Other)   :  2514   (Other)            :698195                     
##      Clicks                        Last.Open     
##  Min.   :     0.00   2017/04/17 15:11:58:    14  
##  1st Qu.:     0.00   2017/04/17 15:19:49:    13  
##  Median :     0.00   2017/04/17 15:09:27:    12  
##  Mean   :    11.16   2017/04/17 15:11:35:    12  
##  3rd Qu.:     2.00   2017/04/19 09:02:46:    12  
##  Max.   :154125.00   (Other)            :548707  
##                      NA's               :156374  
##                Last.Click                  Optout.Time    
##  2016/01/28 12:28:12:     5   2016/04/14 10:21:45:   204  
##  2016/08/25 16:01:41:     5   2016/04/14 10:21:44:   185  
##  2016/08/25 16:01:46:     5   2016/04/14 10:21:46:   177  
##  2016/08/25 16:01:49:     5   2016/04/14 10:21:41:   169  
##  2017/04/18 10:46:26:     5   2016/04/14 10:21:40:   168  
##  (Other)            :270041   (Other)            :185185  
##  NA's               :435078   NA's               :519056  
##         Geolocation.City  Geolocation.State Geolocation.Country
##  Houston, TX US :  2328   CA US  : 20271    US     :255894     
##  Dallas, TX US  :  2246   FL US  : 19022    CA     :  4402     
##  Chicago, IL US :  2098   TX US  : 18583    GB     :   917     
##  New York, NY US:  2042   NY US  : 14390    AU     :   693     
##  Phoenix, AZ US :  1624   PA US  : 11478    MX     :   355     
##  (Other)        :245282   (Other):174660    (Other):  4844     
##  NA's           :449524   NA's   :446740    NA's   :438039     
##  Geolocation.Zip   Lifetime.Message          Top.Device    
##  75270 US:  1559   Min.   :   0.0   iPad          : 45865  
##  77002 US:   614   1st Qu.: 113.0   Android       : 44072  
##  K2H CA  :   449   Median : 338.0   Chrome        : 43394  
##  60602 US:   349   Mean   : 402.7   iPhone        : 38707  
##  95103 US:   346   3rd Qu.: 559.0   Android Tablet: 31390  
##  (Other) :246782   Max.   :3855.0   (Other)       : 60607  
##  NA's    :455045                    NA's          :441109  
##    referral_source      first_name        last_name           age        
##  DMi       :243435   Mary    :  1987   Smith   :  2663   Min.   :  0.0   
##  Facebook  :146656   Linda   :  1978   Johnson :  2149   1st Qu.: 35.0   
##  Untagged  : 71084   Jennifer:  1949   Williams:  1949   Median : 47.0   
##  LiveIntent: 47852   Lisa    :  1628   Jones   :  1672   Mean   : 46.9   
##  torsweeps : 20929   Jessica :  1513   Brown   :  1581   3rd Qu.: 58.0   
##  (Other)   :100052   (Other) :273439   (Other) :272418   Max.   :947.0   
##  NA's      : 75136   NA's    :422650   NA's    :422712   NA's   :702813  
##   gender      
##  f   :  2041  
##  m   :   292  
##  NA's:702811  
##               
##               
##               
##               
##                                                                                                                                                                                                                                                           ebb_preferences  
##  [&quot;bestsellers&quot;,&quot;book_club_picks&quot;,&quot;biographies_and_memoir&quot;,&quot;childrens&quot;,&quot;general_nonfiction&quot;,&quot;historical_fiction&quot;,&quot;history&quot;,&quot;lifestyle_and_cooking&quot;,&quot;literary_fiction&quot;,&quot;mysteries_thrillers_true_crime&quot;,&quot;poetry&quot;,&quot;romance&quot;,&quot;science_fiction_fantasy&quot;,&quot;young_adult&quot;]: 39045  
##  [&quot;childrens&quot;,&quot;historical_fiction&quot;,&quot;literary_fiction&quot;,&quot;mysteries_thrillers_true_crime&quot;,&quot;romance&quot;,&quot;science_fiction_fantasy&quot;,&quot;young_adult&quot;,&quot;biographies_and_memoir&quot;,&quot;general_nonfiction&quot;,&quot;history&quot;,&quot;lifestyle_and_cooking&quot;,&quot;poetry&quot;,&quot;bestsellers&quot;,&quot;book_club_picks&quot;]: 19907  
##  [&quot;bestsellers&quot;,&quot;biographies_and_memoir&quot;,&quot;book_club_picks&quot;,&quot;childrens&quot;,&quot;general_nonfiction&quot;,&quot;historical_fiction&quot;,&quot;history&quot;,&quot;lifestyle_and_cooking&quot;,&quot;literary_fiction&quot;,&quot;mysteries_thrillers_true_crime&quot;,&quot;poetry&quot;,&quot;romance&quot;,&quot;science_fiction_fantasy&quot;,&quot;young_adult&quot;]:  6861  
##  [&quot;romance&quot;]                                                                                                                                                                                                                                                      :  6609  
##  [&quot;mysteries_thrillers_true_crime&quot;]                                                                                                                                                                                                                               :  5771  
##  (Other)                                                                                                                                                                                                                                                          :341718  
##  NA's                                                                                                                                                                                                                                                             :285233</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(subdata)</code></pre></div>
<pre><code>## 'data.frame':    705144 obs. of  21 variables:
##  $ Profile.Id         : Factor w/ 705144 levels &quot;539f4216a256ab65720001de&quot;,..: 182563 76092 416221 575410 115531 580586 517447 264518 62166 99289 ...
##  $ Domain             : Factor w/ 21851 levels &quot;0101press.com&quot;,..: 16632 8727 21499 7440 16632 8727 21499 7440 8781 21499 ...
##  $ Engagement         : Factor w/ 8 levels &quot;active&quot;,&quot;disengaged&quot;,..: 5 7 7 3 7 8 7 2 5 5 ...
##  $ Signup             : Factor w/ 593820 levels &quot;2014/06/16 15:14:30&quot;,..: 166407 61497 357109 491293 100629 496457 437719 246076 47875 84488 ...
##  $ Opens              : int  51 2 0 0 30 54 16 16 0 0 ...
##  $ Clicks             : int  11 0 0 0 1 29 0 0 0 0 ...
##  $ Last.Open          : Factor w/ 507871 levels &quot;2014/07/10 12:40:02&quot;,..: 86324 11194 NA NA 16146 447201 156939 322770 NA NA ...
##  $ Last.Click         : Factor w/ 265929 levels &quot;2014/07/10 13:00:31&quot;,..: 38022 NA NA NA 12499 222564 NA NA NA NA ...
##  $ Optout.Time        : Factor w/ 182773 levels &quot;2014/07/09 20:01:01&quot;,..: NA 9539 69207 NA 13116 NA 94833 NA NA NA ...
##  $ Geolocation.City   : Factor w/ 15290 levels &quot;'s-gravenzande, 11 NL&quot;,..: 4040 NA NA NA NA 1271 NA NA NA NA ...
##  $ Geolocation.State  : Factor w/ 902 levels &quot;00 AI&quot;,&quot;00 AS&quot;,..: 680 NA NA NA NA 794 NA NA NA NA ...
##  $ Geolocation.Country: Factor w/ 167 levels &quot;A1&quot;,&quot;AD&quot;,&quot;AE&quot;,..: 156 NA NA NA 156 156 NA NA NA NA ...
##  $ Geolocation.Zip    : Factor w/ 22138 levels &quot;00-343 PL&quot;,&quot;00002 FI&quot;,..: 19892 NA NA NA NA 10744 NA NA NA NA ...
##  $ Lifetime.Message   : int  169 203 10 257 39 235 9 632 1 1 ...
##  $ Top.Device         : Factor w/ 22 levels &quot;Android&quot;,&quot;Android Tablet&quot;,..: 14 NA NA NA 1 4 NA NA NA NA ...
##  $ referral_source    : Factor w/ 75 levels &quot;AdRoll&quot;,&quot;aramis&quot;,..: 13 70 13 21 NA 29 36 13 70 21 ...
##  $ first_name         : Factor w/ 47086 levels &quot; Connie&quot;,&quot;.Jennifer&quot;,..: 4476 NA 1853 NA NA NA NA 35999 NA NA ...
##  $ last_name          : Factor w/ 82501 levels &quot; Bonham&quot;,&quot; burton&quot;,..: 28725 NA 1845 NA NA NA NA 20226 NA NA ...
##  $ age                : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ gender             : Factor w/ 2 levels &quot;f&quot;,&quot;m&quot;: NA NA NA NA NA NA NA NA NA NA ...
##  $ ebb_preferences    : Factor w/ 20325 levels &quot;\&quot;Bestsellers\&quot;,\&quot;Romance\&quot;,\&quot;Literary Fiction\&quot;]&quot;,..: 8105 NA NA 5660 NA 16039 12950 10969 NA NA ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">unique</span>(subdata<span class="op">$</span>Profile.Id))</code></pre></div>
<pre><code>## [1] 705144</code></pre>
<p>We can consider each Profile.Id to be a unique Subscriber, hence in total we have 705144 subscribers</p>
<p>Convert Signup(Date, Time) to Date, changing data type from factor to date</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">subdata<span class="op">$</span>Date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(subdata<span class="op">$</span>Signup) <span class="co"># storing in a new column 'Date'</span>
<span class="kw">str</span>(subdata<span class="op">$</span>Date)</code></pre></div>
<pre><code>##  Date[1:705144], format: &quot;2015-06-06&quot; &quot;2014-10-17&quot; &quot;2016-02-24&quot; &quot;2016-09-24&quot; &quot;2014-12-22&quot; ...</code></pre>
<hr />
<hr />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Let's break the Date column into Year</span>
subdata<span class="op">$</span>Year &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">format</span>(subdata<span class="op">$</span>Date, <span class="st">&quot;%Y&quot;</span> ))
<span class="kw">str</span>(subdata<span class="op">$</span>Year)</code></pre></div>
<pre><code>##  num [1:705144] 2015 2014 2016 2016 2014 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages('plyr')</span>
<span class="kw">library</span>(plyr)
yearcount &lt;-<span class="st"> </span><span class="kw">count</span>(subdata, <span class="st">'Year'</span>)
yearcount</code></pre></div>
<pre><code>##   Year   freq
## 1 2014 124879
## 2 2015 195409
## 3 2016 299252
## 4 2017  85604</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plotting above data</span>

<span class="co"># install.packages('ggplot2')</span>
<span class="kw">library</span>(ggplot2)

<span class="kw">ggplot</span>(yearcount, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> freq)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> freq), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Number of Subscribers&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Number of Subscribers per Year&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> freq), <span class="dt">vjust =</span> <span class="op">-</span><span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /> We got most subscribers in the year 2016</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Let's see referral sources</span>
<span class="kw">count</span>(subdata, <span class="st">'referral_source'</span>)</code></pre></div>
<pre><code>##     referral_source   freq
## 1            AdRoll      5
## 2            aramis   2132
## 3           bookbub    167
## 4           Bookbub      5
## 5          Bookpage     50
## 6          BookPage   1345
## 7          bookriot    214
## 8          Bookriot      9
## 9    BookRiotSweeps  10598
## 10          Bookstr      4
## 11            cerkl      1
## 12      chickensoup      4
## 13              DMi 243435
## 14      dmi_qhealth  19352
## 15     dunkindonuts      1
## 16 Early Bird Books      1
## 17        EBB Embed    808
## 18            EBBV2      9
## 19   Email Campaign     17
## 20         facebook    358
## 21         Facebook 146656
## 22     facebook.com      3
## 23   Facebook_Leads    243
## 24      FBGiveaways    782
## 25            fyntr  13795
## 26           google   1156
## 27           Google   6171
## 28     HumbleBundle   2689
## 29       In Book Ad  17859
## 30     instafreebie    302
## 31      JBF Members     11
## 32       litbreaker     28
## 33       Litbreaker     17
## 34           LitHub     47
## 35            Litsy      5
## 36       LiveIntent  47852
## 37        new value      1
## 38       NoiseTrade    188
## 39    Off the Shelf     14
## 40           optint   2209
## 41           Paypal      1
## 42        peachtree      2
## 43  Permission Data  11216
## 44        Pinterest      3
## 45    pinterest.com      1
## 46        Portalist     33
## 47            quora      2
## 48        ralph.com      5
## 49        ralphtest      1
## 50    ReadItForward     86
## 51           Reddit      8
## 52         Sailthru   2084
## 53  Shelf Awareness    695
## 54          Shelfie    211
## 55 Standard Display      7
## 56        SwagBucks    511
## 57          Taboola      5
## 58         TAFemail      2
## 59             test      1
## 60             Test      1
## 61      The Line Up     16
## 62     The Line Up      64
## 63       The Lineup      6
## 64          Tiburon     23
## 65              TLU   2447
## 66      tlucheckbox   1251
## 67        torsweeps  20929
## 68          twitter      1
## 69          Twitter     16
## 70         Untagged  71084
## 71            Viber      1
## 72      WarIsBoring     34
## 73     WelcomeEmail    694
## 74            worth      4
## 75       worthbooks     20
## 76             &lt;NA&gt;  75136</code></pre>
<p>We can see that bookbub, Bookbub; Bookpage, BookPage; bookriot, Bookriot; google, Google; facebook, Facebook, facebook.com; litbreaker, Litbreaker; Pinterest, pinterest.com; The Line Up, The Line Up, The Lineup ; and twitter, Twitter are counted separately per year, let's rename them</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">subdata<span class="op">$</span>referral_source[subdata<span class="op">$</span>referral_source <span class="op">==</span><span class="st"> 'bookbub'</span>] &lt;-<span class="st"> 'Bookbub'</span>
subdata<span class="op">$</span>referral_source[subdata<span class="op">$</span>referral_source <span class="op">==</span><span class="st"> 'Bookpage'</span>] &lt;-<span class="st"> 'BookPage'</span>
subdata<span class="op">$</span>referral_source[subdata<span class="op">$</span>referral_source <span class="op">==</span><span class="st"> 'bookriot'</span>] &lt;-<span class="st"> 'Bookriot'</span>
subdata<span class="op">$</span>referral_source[subdata<span class="op">$</span>referral_source <span class="op">==</span><span class="st"> 'google'</span>] &lt;-<span class="st"> 'Google'</span>
subdata<span class="op">$</span>referral_source[subdata<span class="op">$</span>referral_source <span class="op">==</span><span class="st"> 'facebook'</span>] &lt;-<span class="st"> 'Facebook'</span>
subdata<span class="op">$</span>referral_source[subdata<span class="op">$</span>referral_source <span class="op">==</span><span class="st"> 'facebook.com'</span>] &lt;-<span class="st"> 'Facebook'</span>
subdata<span class="op">$</span>referral_source[subdata<span class="op">$</span>referral_source <span class="op">==</span><span class="st"> 'litbreaker'</span>] &lt;-<span class="st"> 'Litbreaker'</span>
subdata<span class="op">$</span>referral_source[subdata<span class="op">$</span>referral_source <span class="op">==</span><span class="st"> 'pinterest.com'</span>] &lt;-<span class="st"> 'Pinterest'</span>
subdata<span class="op">$</span>referral_source[subdata<span class="op">$</span>referral_source <span class="op">==</span><span class="st"> 'The Line Up '</span>] &lt;-<span class="st"> 'The Lineup'</span>
subdata<span class="op">$</span>referral_source[subdata<span class="op">$</span>referral_source <span class="op">==</span><span class="st"> 'The Line Up'</span>] &lt;-<span class="st"> 'The Lineup'</span>
subdata<span class="op">$</span>referral_source[subdata<span class="op">$</span>referral_source <span class="op">==</span><span class="st"> 'twitter'</span>] &lt;-<span class="st"> 'Twitter'</span></code></pre></div>
<p>Count number of subscribers we acquired each year by referral source</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">aggregate</span>(Profile.Id <span class="op">~</span><span class="st"> </span>referral_source <span class="op">+</span><span class="st"> </span>Year, <span class="dt">data =</span> subdata, length)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y1 &lt;-<span class="st"> </span>y[<span class="kw">with</span>(y,<span class="kw">order</span>(<span class="op">-</span>Profile.Id)),]
y1 &lt;-<span class="st"> </span>y1[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]
y1</code></pre></div>
<pre><code>##     referral_source Year Profile.Id
## 83              DMi 2016     132843
## 48              DMi 2015     109727
## 39         Untagged 2014      71084
## 89         Facebook 2016      46124
## 52         Facebook 2015      43695
## 11         Facebook 2014      36497
## 101      LiveIntent 2016      33947
## 136        Facebook 2017      20701
## 154       torsweeps 2017      18649
## 84      dmi_qhealth 2016      18536</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(y1, <span class="kw">aes</span>(<span class="dt">x =</span> referral_source, <span class="dt">y =</span> Profile.Id)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> y1<span class="op">$</span>Year), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Source&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Number of Subscribers&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Number of Subscribers per Year&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="co">#geom_text(aes(label = Profile.Id), vjust = -1) +</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">65</span>, <span class="dt">vjust =</span> <span class="fl">0.6</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Let's break the Date column into Month</span>
subdata<span class="op">$</span>Month &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">format</span>(subdata<span class="op">$</span>Date, <span class="st">&quot;%B&quot;</span> ))</code></pre></div>
<p>Count number of subscribers we acquired each month by referral source</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z &lt;-<span class="st"> </span><span class="kw">aggregate</span>(Profile.Id <span class="op">~</span><span class="st"> </span>referral_source <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(Month, <span class="dt">levels =</span> month.name), <span class="dt">data =</span> subdata, length)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z1 &lt;-<span class="st"> </span>z[<span class="kw">with</span>(z,<span class="kw">order</span>(<span class="op">-</span>Profile.Id)),]
z1 &lt;-<span class="st"> </span>z1[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]
z1</code></pre></div>
<pre><code>##     referral_source factor(Month, levels = month.name) Profile.Id
## 6               DMi                            January      43393
## 288             DMi                          September      34481
## 253             DMi                             August      31607
## 81              DMi                              March      30295
## 43              DMi                           February      30243
## 10         Facebook                            January      25875
## 317        Untagged                          September      25653
## 405        Facebook                           December      24926
## 187             DMi                               June      23126
## 355        Untagged                            October      21849</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(z1, <span class="kw">aes</span>(<span class="dt">x =</span> referral_source, <span class="dt">y =</span> Profile.Id)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> z1<span class="op">$</span><span class="st">`</span><span class="dt">factor(Month, levels = month.name)</span><span class="st">`</span>), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Source&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Number of Subscribers&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Number of Subscribers per Month&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="co">#geom_text(aes(label = Profile.Id), vjust = -1) +</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">65</span>, <span class="dt">vjust =</span> <span class="fl">0.6</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /> In the month of January, DMi gave us 43393 suscribers</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">aggregate</span>(Profile.Id <span class="op">~</span><span class="st"> </span>referral_source <span class="op">+</span><span class="st"> </span>Year <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(Month, <span class="dt">levels =</span> month.name), <span class="dt">data =</span> subdata, length)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1 &lt;-<span class="st"> </span>x[<span class="kw">with</span>(x,<span class="kw">order</span>(<span class="op">-</span>Profile.Id)),]
x1 &lt;-<span class="st"> </span>x1[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]
x1</code></pre></div>
<pre><code>##     referral_source Year factor(Month, levels = month.name) Profile.Id
## 29              DMi 2016                            January      43233
## 557             DMi 2015                          September      34250
## 479             DMi 2015                             August      31466
## 172             DMi 2016                              March      30259
## 102             DMi 2016                           February      30156
## 550        Untagged 2014                          September      25653
## 339             DMi 2015                               June      22997
## 625        Untagged 2014                            October      21849
## 756        Facebook 2014                           December      18979
## 8          Facebook 2015                            January      17053</code></pre>
<p>43233 subscribers were acquired in the month of January, 2016, via DMi.</p>
<hr />
<hr />
<p>Let us create a new data frame consisting of subscriber and their preferences</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(subdata)
subdata_ebb &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Profile.Id, ebb_preferences)
<span class="kw">detach</span>(subdata)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Now let's remove square brackets and quotations from preferences</span>

subdata_ebb<span class="op">$</span>ebb_preferences &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;&quot;</span>, <span class="kw">gsub</span>(<span class="st">&quot;[][]&quot;</span>, <span class="st">&quot;&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences), <span class="st">&quot;&quot;</span>) <span class="co"># removing square brackets</span>

subdata_ebb<span class="op">$</span>ebb_preferences &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;&quot;</span>, <span class="kw">gsub</span>(<span class="st">'&quot;&quot;'</span>, <span class="st">&quot;&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences), <span class="st">&quot;&quot;</span>) <span class="co"># removing quotations</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">subdata_ebb<span class="op">$</span>ebb_preferences &lt;-<span class="st"> </span><span class="kw">sapply</span>(subdata_ebb<span class="op">$</span>ebb_preferences, <span class="cf">function</span>(x) <span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="st">&quot;&quot;</span>, x)) <span class="co"># remove \&quot; from preferences </span>

subdata_ebb<span class="op">$</span>ebb_preferences &lt;-<span class="st"> </span><span class="kw">as.character</span>(subdata_ebb<span class="op">$</span>ebb_preferences) <span class="co"># store this as character</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Let's see total count of preferences per subscriber</span>
<span class="kw">library</span>(stringi)
subdata_ebb<span class="op">$</span>ebb_preferences_count &lt;-<span class="st"> </span><span class="kw">stri_count_words</span>(subdata_ebb<span class="op">$</span>ebb_preferences)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The missing values should be replaced with maximum preferences number, let's find that</span>
<span class="kw">summary</span>(<span class="kw">as.factor</span>(subdata_ebb<span class="op">$</span>ebb_preferences_count))</code></pre></div>
<pre><code>##      0      1      2      3      4      5      6      7      8      9 
##      7 318557  30035  36266  32807  29289  26739  25660  26556  28659 
##     10     11     12     13     14     16 
##  26501  24256  19495  14501  65814      2</code></pre>
<p>We see that most of the preferences are 14(only 2 values for 16 so we exclude it)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fill empty values in preferences with 14</span>
subdata_ebb<span class="op">$</span>ebb_preferences_count[subdata_ebb<span class="op">$</span>ebb_preferences <span class="op">==</span><span class="st"> 'NA'</span>] &lt;-<span class="st"> </span><span class="dv">14</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot above data</span>

<span class="kw">ggplot</span>(subdata_ebb, <span class="kw">aes</span>(ebb_preferences_count)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Preferences&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Number of Subscribers&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Number of Subscribers&quot;</span>)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="data:image/png;base64,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" /> Most subscribers are subscribing to all 14 preferences. It might be because most people prefer default selection.</p>
<hr />
<hr />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Let's store preferences into a list</span>
preferences &lt;-<span class="st"> </span><span class="kw">strsplit</span>(subdata_ebb<span class="op">$</span>ebb_preferences, <span class="dt">split =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">fixed =</span> <span class="ot">TRUE</span>)
<span class="co"># head(preferences)</span>

preferences_unlist &lt;-<span class="st"> </span><span class="kw">unlist</span>(preferences)
<span class="co"># head(preferences_unlist, 10)</span>

<span class="kw">unique</span>(preferences_unlist)</code></pre></div>
<pre><code>##   [1] &quot;bestsellers&quot;                    &quot;mysteries_thrillers_true_crime&quot;
##   [3] &quot;science_fiction_fantasy&quot;        &quot;literary_fiction&quot;              
##   [5] &quot;general_nonfiction&quot;             &quot;NA&quot;                            
##   [7] &quot;book_club_picks&quot;                &quot;historical_fiction&quot;            
##   [9] &quot;romance&quot;                        &quot;young_adult&quot;                   
##  [11] &quot;biographies_and_memoir&quot;         &quot;lifestyle_and_cooking&quot;         
##  [13] &quot;childrens&quot;                      &quot;history&quot;                       
##  [15] &quot;poetry&quot;                         &quot;mysteries_thrillers_&quot;          
##  [17] &quot;romanc&quot;                         &quot;general_nonficti&quot;              
##  [19] &quot;mysteries_thri&quot;                 &quot;you&quot;                           
##  [21] &quot;science_fiction_fanta&quot;          &quot;science_fiction_&quot;              
##  [23] &quot;hist&quot;                           &quot;science_fiction_fantas&quot;        
##  [25] &quot;youn&quot;                           &quot;mysteries_thrillers_true_c&quot;    
##  [27] &quot;y&quot;                              &quot;science_fiction_fa&quot;            
##  [29] &quot;poet&quot;                           &quot;po&quot;                            
##  [31] &quot;scienc&quot;                         &quot;yo&quot;                            
##  [33] &quot;young_&quot;                         &quot;lifestyle_and_co&quot;              
##  [35] &quot;scien&quot;                          &quot;science_fict&quot;                  
##  [37] &quot;sci&quot;                            &quot;lifestyl&quot;                      
##  [39] &quot;roma&quot;                           &quot;science_ficti&quot;                 
##  [41] &quot;ro&quot;                             &quot;roman&quot;                         
##  [43] &quot;general_nonfictio&quot;              &quot;young&quot;                         
##  [45] &quot;science_fictio&quot;                 &quot;science_&quot;                      
##  [47] &quot;science_fiction_fant&quot;           &quot;mysteries_thrillers_true_cr&quot;   
##  [49] &quot;young_adu&quot;                      &quot;science&quot;                       
##  [51] &quot;mysteries_thrillers_tru&quot;        &quot;young_ad&quot;                      
##  [53] &quot;young_adul&quot;                     &quot;poetr&quot;                         
##  [55] &quot;mysteries_thrillers_true_crim&quot;  &quot;science_fiction_f&quot;             
##  [57] &quot;gener&quot;                          &quot;rom&quot;                           
##  [59] &quot;g&quot;                              &quot;mysteries_thrillers_t&quot;         
##  [61] &quot;mysteries_th&quot;                   &quot;science_fi&quot;                    
##  [63] &quot;s&quot;                              &quot;p&quot;                             
##  [65] &quot;science_fiction_fan&quot;            &quot;History&quot;                       
##  [67] &quot;General Nonfiction&quot;             &quot;Children's&quot;                    
##  [69] &quot;Romance&quot;                        &quot;Young Adult&quot;                   
##  [71] &quot;Historical Fiction&quot;             &quot;general_n&quot;                     
##  [73] &quot;sc&quot;                             &quot;childre&quot;                       
##  [75] &quot;science_fiction&quot;                &quot;general_nonfi&quot;                 
##  [77] &quot;r&quot;                              &quot;lifestyle_and_cooki&quot;           
##  [79] &quot;science_fic&quot;                    &quot;poe&quot;                           
##  [81] &quot;general_no&quot;                     &quot;mysteries_thrill&quot;              
##  [83] &quot;general_nonfic&quot;                 &quot;scie&quot;                          
##  [85] &quot;science_f&quot;                      &quot;genera&quot;                        
##  [87] &quot;literary_fic&quot;                   &quot;chi&quot;                           
##  [89] &quot;chil&quot;                           &quot;young_a&quot;                       
##  [91] &quot;ge&quot;                             &quot;c&quot;                             
##  [93] &quot;mysteries_thrillers_tr&quot;         &quot;life&quot;                          
##  [95] &quot;children&quot;                       &quot;ScienceFiction&quot;                
##  [97] &quot;Bestsellers&quot;                    &quot;null&quot;                          
##  [99] &quot;Science Fiction &amp; Fantasy&quot;      &quot;mysteries_thrillers_true_cri&quot;  
## [101] &quot;general_nonf&quot;                   &quot;gen&quot;                           
## [103] &quot;general_&quot;                       &quot;lifestyle_and_c&quot;               
## [105] &quot;lifestyle_and&quot;                  &quot;general_non&quot;                   
## [107] &quot;childr&quot;                         &quot;ch&quot;                            
## [109] &quot;lifestyle_an&quot;                   &quot;child&quot;                         
## [111] &quot;lifestyle_and_cookin&quot;           &quot;gene&quot;                          
## [113] &quot;Literary Fiction&quot;               &quot;Biography and Memoir&quot;          
## [115] &quot;general_nonfict&quot;                &quot;Mysteries&quot;                     
## [117] &quot; Thrillers&quot;                     &quot; &amp; True Crime&quot;                 
## [119] &quot; Thrillers &amp; True Crime&quot;        &quot;someEBBPref&quot;                   
## [121] &quot;Lifestyle and Cooking&quot;          &quot;Poetry&quot;                        
## [123] &quot;&quot;</code></pre>
<p>We have repetitions here, Let us write down the above list without repetitions and significant preferences bestsellers mysteries_thrillers_true_crime science_fiction_fantasy literary_fiction general_nonfiction book_club_picks historical_fiction romance young_adult biographies_and_memoir lifestyle_and_cooking childrens history poetry</p>
<p>We can also see that there are characters y, g, s, p, r, c which in themself do not signify any preference, so we check and drop them</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">which</span>(preferences_unlist <span class="op">==</span><span class="st"> &quot;y&quot;</span>)</code></pre></div>
<pre><code>##  [1]    9006  143312  286912  365405  465488  483784  497426  538954
##  [9]  589081  593034  614938  628426  642067  749134  767544  832235
## [17]  851308  869730  915719  947259  968635 1003413 1025742 1033008
## [25] 1101850 1112233 1131918 1213165 1220613 1246426 1357674 1384929
## [33] 1416850 1520314 1542661 1556394 1588104 1634113 1651756 1679796
## [41] 1709407 1758462 1769722 1773386 1788792 1894435 1914599 1956523
## [49] 1959865 1973000 1981924 2221795 2236944 2265651 2356660 2368875
## [57] 2383356 2411042 2427554 2480254 2532792 2611566 2685209 2790593
## [65] 2818580 2916982 2918390 2933006 2933914 2956260 2973032 2977901
## [73] 2987846 3028387 3122876 3129410 3276839 3367384</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">which</span>(preferences_unlist <span class="op">==</span><span class="st"> &quot;g&quot;</span>)</code></pre></div>
<pre><code>##  [1]   62909  203421  579843 1780677 2001154 2005426 2247205 2278021
##  [9] 2437267 2755276</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">which</span>(preferences_unlist <span class="op">==</span><span class="st"> &quot;s&quot;</span>)</code></pre></div>
<pre><code>##  [1]   77876  109024  164151  212281  234094  255689  342216  357967
##  [9]  471670  576162  640450  728521 1020886 1022035 1049130 1140165
## [17] 1152231 1477817 1511421 1529646 1658757 1825786 1831427 1930225
## [25] 2073050 2083411 2148628 2243826 2376436 2396210 2423567 2467782
## [33] 2565696 2655593 2723918 2772430 2983514 2991624 3004482 3029191</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">which</span>(preferences_unlist <span class="op">==</span><span class="st"> &quot;p&quot;</span>)</code></pre></div>
<pre><code>##  [1]   81937  188277  533156  655946  852211 1685998 2065580 2096973
##  [9] 2223186 2564666 2609015 2911678 2991383 3010160</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">which</span>(preferences_unlist <span class="op">==</span><span class="st"> &quot;r&quot;</span>)</code></pre></div>
<pre><code>##  [1]  104019  163410  187929  188562  296344  406778  409721  418828
##  [9]  498546  579077  611710  640325  723335  747176  771377  817368
## [17]  929777  947825  992712  994319 1022765 1059707 1462142 1531353
## [25] 1546775 1562972 1600972 1607456 1619046 1621721 1654238 1705368
## [33] 1727175 1832016 1850662 1889489 1904579 1931668 2047834 2138427
## [41] 2178499 2557592 2795140 2871701 2873264 2885740 2892100 2917110
## [49] 3023617 3314463</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">which</span>(preferences_unlist <span class="op">==</span><span class="st"> &quot;c&quot;</span>)</code></pre></div>
<pre><code>## [1]  308474 1185638 1280567 2533429 2623631</code></pre>
<p>There are not a whole lot of them, so we will notinclude them</p>
<p>Let us match the pattern in preferences and encode them into binary columns</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">subdata_ebb<span class="op">$</span>bestsellers &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;bestsellers&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences, <span class="dt">fixed =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,<span class="dv">0</span>)
subdata_ebb<span class="op">$</span>mysteries &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;mysteries&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences, <span class="dt">fixed =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,<span class="dv">0</span>)
subdata_ebb<span class="op">$</span>science_fiction &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;sc&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences, <span class="dt">fixed =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,<span class="dv">0</span>)
subdata_ebb<span class="op">$</span>lit_fiction &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;literary_fic&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences, <span class="dt">fixed =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,<span class="dv">0</span>)
subdata_ebb<span class="op">$</span>general_nonfiction &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;ge&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences, <span class="dt">fixed =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,<span class="dv">0</span>)
subdata_ebb<span class="op">$</span>book_club_picks &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;book_club_picks&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences, <span class="dt">fixed =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,<span class="dv">0</span>)
subdata_ebb<span class="op">$</span>historical_fiction &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;hist&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences, <span class="dt">fixed =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,<span class="dv">0</span>)
subdata_ebb<span class="op">$</span>romance &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;ro&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences, <span class="dt">fixed =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,<span class="dv">0</span>)
subdata_ebb<span class="op">$</span>young_adult &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;yo&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences, <span class="dt">fixed =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,<span class="dv">0</span>)
subdata_ebb<span class="op">$</span>bio_memoirs &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;bio&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences, <span class="dt">fixed =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,<span class="dv">0</span>)
subdata_ebb<span class="op">$</span>lifestyle_cooking&lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;life&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences, <span class="dt">fixed =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,<span class="dv">0</span>)
subdata_ebb<span class="op">$</span>childrens &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;ch&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences, <span class="dt">fixed =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,<span class="dv">0</span>)
subdata_ebb<span class="op">$</span>history&lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;history&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences, <span class="dt">fixed =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,<span class="dv">0</span>)
subdata_ebb<span class="op">$</span>poetry &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;po&quot;</span>, subdata_ebb<span class="op">$</span>ebb_preferences, <span class="dt">fixed =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,<span class="dv">0</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(subdata_ebb)</code></pre></div>
<pre><code>##                 Profile.Id
## 1 5572fb5592721912198b587b
## 2 5441111b66dfa5ab01b0a000
## 3 56cde9d9d9cb94486d8b51d7
## 4 57e68298d9cb942a708b48db
## 5 5498bd77f641910f100e23fb
## 6 57f84fbad9cb94f1778b50d7
##                                                                                                                                                   ebb_preferences
## 1                                                          bestsellers,mysteries_thrillers_true_crime,science_fiction_fantasy,literary_fiction,general_nonfiction
## 2                                                                                                                                                              NA
## 3                                                                                                                                                              NA
## 4                                                                                                                                     bestsellers,book_club_picks
## 5                                                                                                                                                              NA
## 6 historical_fiction,literary_fiction,mysteries_thrillers_true_crime,romance,young_adult,biographies_and_memoir,lifestyle_and_cooking,bestsellers,book_club_picks
##   ebb_preferences_count bestsellers mysteries science_fiction lit_fiction
## 1                     5           1         1               1           1
## 2                    14           0         0               0           0
## 3                    14           0         0               0           0
## 4                     2           1         0               0           0
## 5                    14           0         0               0           0
## 6                     9           1         1               0           1
##   general_nonfiction book_club_picks historical_fiction romance
## 1                  1               0                  0       0
## 2                  0               0                  0       0
## 3                  0               0                  0       0
## 4                  0               1                  0       0
## 5                  0               0                  0       0
## 6                  0               1                  1       1
##   young_adult bio_memoirs lifestyle_cooking childrens history poetry
## 1           0           0                 0         0       0      0
## 2           0           0                 0         0       0      0
## 3           0           0                 0         0       0      0
## 4           0           0                 0         0       0      0
## 5           0           0                 0         0       0      0
## 6           1           1                 1         0       0      0</code></pre>
<hr />
<h3 id="predictive-model">Predictive Model</h3>
<p>Let us prepare our data Let's again look at all the columns we got</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(subdata)</code></pre></div>
<pre><code>##  [1] &quot;Profile.Id&quot;          &quot;Domain&quot;              &quot;Engagement&quot;         
##  [4] &quot;Signup&quot;              &quot;Opens&quot;               &quot;Clicks&quot;             
##  [7] &quot;Last.Open&quot;           &quot;Last.Click&quot;          &quot;Optout.Time&quot;        
## [10] &quot;Geolocation.City&quot;    &quot;Geolocation.State&quot;   &quot;Geolocation.Country&quot;
## [13] &quot;Geolocation.Zip&quot;     &quot;Lifetime.Message&quot;    &quot;Top.Device&quot;         
## [16] &quot;referral_source&quot;     &quot;first_name&quot;          &quot;last_name&quot;          
## [19] &quot;age&quot;                 &quot;gender&quot;              &quot;ebb_preferences&quot;    
## [22] &quot;Date&quot;                &quot;Year&quot;                &quot;Month&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(subdata_ebb)</code></pre></div>
<pre><code>##  [1] &quot;Profile.Id&quot;            &quot;ebb_preferences&quot;      
##  [3] &quot;ebb_preferences_count&quot; &quot;bestsellers&quot;          
##  [5] &quot;mysteries&quot;             &quot;science_fiction&quot;      
##  [7] &quot;lit_fiction&quot;           &quot;general_nonfiction&quot;   
##  [9] &quot;book_club_picks&quot;       &quot;historical_fiction&quot;   
## [11] &quot;romance&quot;               &quot;young_adult&quot;          
## [13] &quot;bio_memoirs&quot;           &quot;lifestyle_cooking&quot;    
## [15] &quot;childrens&quot;             &quot;history&quot;              
## [17] &quot;poetry&quot;</code></pre>
<p>Domain and Engagement are irrelevant; Geolocation, Age, Gender, TopDevice, referral source have too many missing values, so we will not consider them</p>
<p>For predicting when people willl opt-out of the newsletter we will only be needing significant and related variables. Let's create a new dataframe and store all the significant columns which we are going to consider for prediction</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(subdata)
optoutprediction &lt;-<span class="st"> </span><span class="kw">data.frame</span>(subdata_ebb, Year, Date, Opens, Clicks, Lifetime.Message, Signup, Last.Open, Optout.Time)
<span class="kw">detach</span>(subdata)</code></pre></div>
<p>Let's look at the amount of data missing in Optout Time</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="kw">is.na</span>(optoutprediction<span class="op">$</span>Optout.Time))</code></pre></div>
<pre><code>## [1] 519056</code></pre>
<p>We will drop these rows</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">optoutprediction &lt;-<span class="st"> </span>optoutprediction[<span class="op">!</span><span class="kw">is.na</span>(optoutprediction<span class="op">$</span>Optout.Time), ]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(optoutprediction)</code></pre></div>
<pre><code>## [1] 186088</code></pre>
<p>We are left with 186088 rows only</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">optoutprediction<span class="op">$</span>optoutduration &lt;-<span class="st"> </span><span class="kw">difftime</span>(optoutprediction<span class="op">$</span>Optout.Time ,optoutprediction<span class="op">$</span>Signup , <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;days&quot;</span>))
optoutprediction<span class="op">$</span>activeduration &lt;-<span class="st"> </span><span class="kw">difftime</span>(optoutprediction<span class="op">$</span>Last.Open ,optoutprediction<span class="op">$</span>Signup , <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;days&quot;</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">max</span>(optoutprediction<span class="op">$</span>optoutduration)</code></pre></div>
<pre><code>## Time difference of 1014.963 days</code></pre>
<p>Also convert date into month</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">optoutprediction<span class="op">$</span>Month &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">format</span>(optoutprediction<span class="op">$</span>Date, <span class="st">&quot;%m&quot;</span> ))</code></pre></div>
<p>ebb_preferences, Date, Signup, Last.Open, Optout.Time is irrelevant, we will drop it</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">optoutprediction<span class="op">$</span>ebb_preferences &lt;-<span class="st"> </span><span class="ot">NULL</span>
optoutprediction<span class="op">$</span>Date &lt;-<span class="st"> </span><span class="ot">NULL</span>
optoutprediction<span class="op">$</span>Signup &lt;-<span class="st"> </span><span class="ot">NULL</span>
optoutprediction<span class="op">$</span>Last.Open &lt;-<span class="st"> </span><span class="ot">NULL</span>
optoutprediction<span class="op">$</span>Optout.Time &lt;-<span class="st"> </span><span class="ot">NULL</span></code></pre></div>
<p>Let's look at the structure of our new dataset</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(optoutprediction)</code></pre></div>
<pre><code>## 'data.frame':    186088 obs. of  23 variables:
##  $ Profile.Id           : Factor w/ 705144 levels &quot;539f4216a256ab65720001de&quot;,..: 76092 416221 115531 517447 111409 290464 370333 25730 355790 545522 ...
##  $ ebb_preferences_count: num  14 14 14 12 10 14 8 14 6 14 ...
##  $ bestsellers          : num  0 0 0 1 1 1 0 0 1 1 ...
##  $ mysteries            : num  0 0 0 0 1 1 1 0 1 1 ...
##  $ science_fiction      : num  0 0 0 1 1 1 1 0 0 1 ...
##  $ lit_fiction          : num  0 0 0 1 1 1 1 0 0 1 ...
##  $ general_nonfiction   : num  0 0 0 1 1 1 0 0 1 1 ...
##  $ book_club_picks      : num  0 0 0 1 1 1 0 0 1 1 ...
##  $ historical_fiction   : num  0 0 0 1 1 1 1 0 1 1 ...
##  $ romance              : num  0 0 0 0 0 1 1 0 0 1 ...
##  $ young_adult          : num  0 0 0 1 1 1 0 0 0 1 ...
##  $ bio_memoirs          : num  0 0 0 1 0 1 0 0 1 1 ...
##  $ lifestyle_cooking    : num  0 0 0 1 1 1 1 0 0 1 ...
##  $ childrens            : num  0 0 0 1 0 1 0 0 0 1 ...
##  $ history              : num  0 0 0 1 1 1 1 0 1 1 ...
##  $ poetry               : num  0 0 0 1 0 1 1 0 0 1 ...
##  $ Year                 : num  2014 2016 2014 2016 2014 ...
##  $ Opens                : int  2 0 30 16 31 20 0 56 29 51 ...
##  $ Clicks               : int  0 0 1 0 5 2 0 1 51 0 ...
##  $ Lifetime.Message     : int  203 10 39 9 438 20 20 859 173 33 ...
##  $ optoutduration       :Class 'difftime'  atomic [1:186088] 35 7.3 15.1 5.4 500 ...
##   .. ..- attr(*, &quot;units&quot;)= chr &quot;days&quot;
##  $ activeduration       :Class 'difftime'  atomic [1:186088] 35 NA 15.1 5.4 500 ...
##   .. ..- attr(*, &quot;units&quot;)= chr &quot;days&quot;
##  $ Month                : Factor w/ 12 levels &quot;01&quot;,&quot;02&quot;,&quot;03&quot;,..: 10 2 12 5 12 10 1 8 1 7 ...</code></pre>
<p>Looks like we have to convert some of the data types</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">optoutprediction<span class="op">$</span>bestsellers &lt;-<span class="st"> </span><span class="kw">as.factor</span>(optoutprediction<span class="op">$</span>bestsellers)
optoutprediction<span class="op">$</span>mysteries &lt;-<span class="st"> </span><span class="kw">as.factor</span>(optoutprediction<span class="op">$</span>mysteries)
optoutprediction<span class="op">$</span>science_fiction &lt;-<span class="st"> </span><span class="kw">as.factor</span>(optoutprediction<span class="op">$</span>science_fiction)
optoutprediction<span class="op">$</span>lit_fiction &lt;-<span class="st"> </span><span class="kw">as.factor</span>(optoutprediction<span class="op">$</span>lit_fiction)
optoutprediction<span class="op">$</span>general_nonfiction &lt;-<span class="st"> </span><span class="kw">as.factor</span>(optoutprediction<span class="op">$</span>general_nonfiction)
optoutprediction<span class="op">$</span>book_club_picks &lt;-<span class="st"> </span><span class="kw">as.factor</span>(optoutprediction<span class="op">$</span>book_club_picks)
optoutprediction<span class="op">$</span>historical_fiction &lt;-<span class="st"> </span><span class="kw">as.factor</span>(optoutprediction<span class="op">$</span>historical_fiction)
optoutprediction<span class="op">$</span>romance &lt;-<span class="st"> </span><span class="kw">as.factor</span>(optoutprediction<span class="op">$</span>romance)
optoutprediction<span class="op">$</span>young_adult &lt;-<span class="st"> </span><span class="kw">as.factor</span>(optoutprediction<span class="op">$</span>young_adult)
optoutprediction<span class="op">$</span>bio_memoirs &lt;-<span class="st"> </span><span class="kw">as.factor</span>(optoutprediction<span class="op">$</span>bio_memoirs)
optoutprediction<span class="op">$</span>lifestyle_cooking &lt;-<span class="st"> </span><span class="kw">as.factor</span>(optoutprediction<span class="op">$</span>lifestyle_cooking)
optoutprediction<span class="op">$</span>childrens &lt;-<span class="st"> </span><span class="kw">as.factor</span>(optoutprediction<span class="op">$</span>childrens)
optoutprediction<span class="op">$</span>history&lt;-<span class="st"> </span><span class="kw">as.factor</span>(optoutprediction<span class="op">$</span>history)
optoutprediction<span class="op">$</span>poetry &lt;-<span class="st"> </span><span class="kw">as.factor</span>(optoutprediction<span class="op">$</span>poetry)
optoutprediction<span class="op">$</span>Year &lt;-<span class="st"> </span><span class="kw">as.factor</span>(optoutprediction<span class="op">$</span>Year)
optoutprediction<span class="op">$</span>optoutduration &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(optoutprediction<span class="op">$</span>optoutduration)
optoutprediction<span class="op">$</span>activeduration &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(optoutprediction<span class="op">$</span>activeduration)</code></pre></div>
<p>Let's look again</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(optoutprediction)</code></pre></div>
<pre><code>## 'data.frame':    186088 obs. of  23 variables:
##  $ Profile.Id           : Factor w/ 705144 levels &quot;539f4216a256ab65720001de&quot;,..: 76092 416221 115531 517447 111409 290464 370333 25730 355790 545522 ...
##  $ ebb_preferences_count: num  14 14 14 12 10 14 8 14 6 14 ...
##  $ bestsellers          : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 2 2 2 1 1 2 2 ...
##  $ mysteries            : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 2 2 2 1 2 2 ...
##  $ science_fiction      : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 2 2 2 2 1 1 2 ...
##  $ lit_fiction          : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 2 2 2 2 1 1 2 ...
##  $ general_nonfiction   : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 2 2 2 1 1 2 2 ...
##  $ book_club_picks      : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 2 2 2 1 1 2 2 ...
##  $ historical_fiction   : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 2 2 2 2 1 2 2 ...
##  $ romance              : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 2 2 1 1 2 ...
##  $ young_adult          : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 2 2 2 1 1 1 2 ...
##  $ bio_memoirs          : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 2 1 2 1 1 2 2 ...
##  $ lifestyle_cooking    : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 2 2 2 2 1 1 2 ...
##  $ childrens            : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 2 1 2 1 1 1 2 ...
##  $ history              : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 2 2 2 2 1 2 2 ...
##  $ poetry               : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 2 1 2 2 1 1 2 ...
##  $ Year                 : Factor w/ 4 levels &quot;2014&quot;,&quot;2015&quot;,..: 1 3 1 3 1 2 3 1 3 3 ...
##  $ Opens                : int  2 0 30 16 31 20 0 56 29 51 ...
##  $ Clicks               : int  0 0 1 0 5 2 0 1 51 0 ...
##  $ Lifetime.Message     : int  203 10 39 9 438 20 20 859 173 33 ...
##  $ optoutduration       : num  35 7.3 15.1 5.4 500 ...
##  $ activeduration       : num  35 NA 15.1 5.4 500 ...
##  $ Month                : Factor w/ 12 levels &quot;01&quot;,&quot;02&quot;,&quot;03&quot;,..: 10 2 12 5 12 10 1 8 1 7 ...</code></pre>
<p>Before applying any model, let's check for missing values</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(optoutprediction)</code></pre></div>
<pre><code>##                     Profile.Id     ebb_preferences_count bestsellers
##  53a30c519dbcd4ed3800026a:     1   Min.   : 1.00         0:96698    
##  53b300c6fdd5ac595400042c:     1   1st Qu.: 7.00         1:89390    
##  53b31af8fdd5ac955c0000c8:     1   Median :14.00                    
##  53b32b8f9dbcd40e6300061d:     1   Mean   :10.38                    
##  53b3481e9dbcd4a063000441:     1   3rd Qu.:14.00                    
##  53b38b06fdd5acba2e000003:     1   Max.   :14.00                    
##  (Other)                 :186082                                    
##  mysteries  science_fiction lit_fiction general_nonfiction book_club_picks
##  0:116409   0:128347        0:127818    0:130183           0:115072       
##  1: 69679   1: 57741        1: 58270    1: 55905           1: 71016       
##                                                                           
##                                                                           
##                                                                           
##                                                                           
##                                                                           
##  historical_fiction romance    young_adult bio_memoirs lifestyle_cooking
##  0:115193           0:126146   0:134181    0:128159    0:129350         
##  1: 70895           1: 59942   1: 51907    1: 57929    1: 56738         
##                                                                         
##                                                                         
##                                                                         
##                                                                         
##                                                                         
##  childrens  history    poetry       Year           Opens         
##  0:138967   0:128971   0:141320   2014:45904   Min.   :    0.00  
##  1: 47121   1: 57117   1: 44768   2015:49996   1st Qu.:    3.00  
##                                   2016:73111   Median :   12.00  
##                                   2017:17077   Mean   :   56.46  
##                                                3rd Qu.:   47.00  
##                                                Max.   :38853.00  
##                                                                  
##      Clicks         Lifetime.Message optoutduration    activeduration   
##  Min.   :   0.000   Min.   :   0     Min.   :-794.90   Min.   :-794.90  
##  1st Qu.:   0.000   1st Qu.:  16     1st Qu.:  13.02   1st Qu.:  13.03  
##  Median :   0.000   Median :  87     Median :  74.30   Median :  72.83  
##  Mean   :   6.107   Mean   : 224     Mean   : 176.07   Mean   : 175.07  
##  3rd Qu.:   3.000   3rd Qu.: 313     3rd Qu.: 269.05   3rd Qu.: 266.65  
##  Max.   :5101.000   Max.   :1855     Max.   :1014.96   Max.   :1014.93  
##                                                        NA's   :11815    
##      Month      
##  01     :22790  
##  09     :22236  
##  02     :22225  
##  08     :18670  
##  12     :16140  
##  03     :14849  
##  (Other):69178</code></pre>
<p>optoutduration and activeduration have negative values which we will make positive, and activeduration has missing values</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">optoutprediction<span class="op">$</span>optoutduration &lt;-<span class="st"> </span><span class="kw">abs</span>(optoutprediction<span class="op">$</span>optoutduration)
optoutprediction<span class="op">$</span>activeduration &lt;-<span class="st"> </span><span class="kw">abs</span>(optoutprediction<span class="op">$</span>activeduration)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(optoutprediction<span class="op">$</span>activeduration)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##    0.00   13.03   72.84  175.09  266.67 1014.93   11815</code></pre>
<p>These missing values can be replace by median</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">optoutprediction<span class="op">$</span>activeduration[<span class="kw">is.na</span>(optoutprediction<span class="op">$</span>activeduration)] &lt;-<span class="st"> </span><span class="kw">median</span>(optoutprediction<span class="op">$</span>activeduration, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(optoutprediction<span class="op">$</span>activeduration) <span class="co"># Now it' good</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    0.00   14.92   72.84  168.60  246.56 1014.93</code></pre>
<h4 id="prediction">Prediction</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">label &lt;-<span class="st"> </span>optoutprediction<span class="op">$</span>optoutduration <span class="co"># our variable for prediction</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
oneortwo &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span> , <span class="kw">length</span>(optoutprediction<span class="op">$</span>Profile.Id), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>)) <span class="co"># generating random values and storing them</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create train data frame</span>
train &lt;-<span class="st"> </span>optoutprediction[oneortwo <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, ]

<span class="co"># create test data frame</span>
test &lt;-<span class="st"> </span>optoutprediction[oneortwo <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, ]</code></pre></div>
<h5 id="lets-apply-linear-regression-model">Let's apply Linear Regression model</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm_fit &lt;-<span class="st"> </span><span class="kw">step</span>(<span class="kw">lm</span>(optoutduration <span class="op">~</span>. <span class="op">-</span>Profile.Id, <span class="dt">data =</span> train), <span class="dt">direction =</span> <span class="st">&quot;both&quot;</span>)</code></pre></div>
<pre><code>## Start:  AIC=1168886
## optoutduration ~ (Profile.Id + ebb_preferences_count + bestsellers + 
##     mysteries + science_fiction + lit_fiction + general_nonfiction + 
##     book_club_picks + historical_fiction + romance + young_adult + 
##     bio_memoirs + lifestyle_cooking + childrens + history + poetry + 
##     Year + Opens + Clicks + Lifetime.Message + activeduration + 
##     Month) - Profile.Id
## 
##                         Df Sum of Sq        RSS     AIC
## - poetry                 1       135  379693687 1168884
## - book_club_picks        1       697  379694249 1168884
## - Clicks                 1      1355  379694907 1168884
## - young_adult            1      1426  379694977 1168884
## - lifestyle_cooking      1      1615  379695167 1168884
## - science_fiction        1      1764  379695316 1168884
## - history                1      2810  379696361 1168885
## - romance                1      3918  379697470 1168885
## - historical_fiction     1      3919  379697471 1168885
## - general_nonfiction     1      4436  379697988 1168885
## &lt;none&gt;                                379693552 1168886
## - mysteries              1      5609  379699161 1168886
## - bestsellers            1      6237  379699788 1168886
## - childrens              1      6561  379700113 1168886
## - bio_memoirs            1      8404  379701956 1168887
## - lit_fiction            1     11380  379704931 1168888
## - ebb_preferences_count  1     35973  379729525 1168898
## - Opens                  1    380425  380073977 1169033
## - Month                 11  21679962  401373514 1177139
## - Year                   3  32268858  411962410 1181035
## - Lifetime.Message       1 124870776  504564328 1211257
## - activeduration         1 819585299 1199278850 1340281
## 
## Step:  AIC=1168884
## optoutduration ~ ebb_preferences_count + bestsellers + mysteries + 
##     science_fiction + lit_fiction + general_nonfiction + book_club_picks + 
##     historical_fiction + romance + young_adult + bio_memoirs + 
##     lifestyle_cooking + childrens + history + Year + Opens + 
##     Clicks + Lifetime.Message + activeduration + Month
## 
##                         Df Sum of Sq        RSS     AIC
## - book_club_picks        1       717  379694404 1168882
## - Clicks                 1      1352  379695039 1168882
## - young_adult            1      1604  379695291 1168882
## - science_fiction        1      1670  379695357 1168882
## - lifestyle_cooking      1      1781  379695468 1168882
## - history                1      2701  379696388 1168883
## - romance                1      3822  379697509 1168883
## - historical_fiction     1      3870  379697557 1168883
## - general_nonfiction     1      4519  379698206 1168883
## &lt;none&gt;                                379693687 1168884
## - mysteries              1      5507  379699194 1168884
## - bestsellers            1      6251  379699938 1168884
## - childrens              1      6708  379700395 1168884
## - bio_memoirs            1      8496  379702183 1168885
## + poetry                 1       135  379693552 1168886
## - lit_fiction            1     11487  379705174 1168886
## - ebb_preferences_count  1     36033  379729720 1168896
## - Opens                  1    380299  380073986 1169031
## - Month                 11  21680861  401374548 1177137
## - Year                   3  32269449  411963136 1181034
## - Lifetime.Message       1 124871866  504565553 1211255
## - activeduration         1 819595211 1199288899 1340280
## 
## Step:  AIC=1168882
## optoutduration ~ ebb_preferences_count + bestsellers + mysteries + 
##     science_fiction + lit_fiction + general_nonfiction + historical_fiction + 
##     romance + young_adult + bio_memoirs + lifestyle_cooking + 
##     childrens + history + Year + Opens + Clicks + Lifetime.Message + 
##     activeduration + Month
## 
##                         Df Sum of Sq        RSS     AIC
## - Clicks                 1      1333  379695737 1168880
## - science_fiction        1      1649  379696053 1168881
## - young_adult            1      1694  379696098 1168881
## - lifestyle_cooking      1      1918  379696322 1168881
## - history                1      2829  379697233 1168881
## - romance                1      3724  379698128 1168881
## - historical_fiction     1      4121  379698525 1168882
## - general_nonfiction     1      5019  379699423 1168882
## &lt;none&gt;                                379694404 1168882
## - mysteries              1      5604  379700008 1168882
## - childrens              1      6554  379700958 1168883
## - bio_memoirs            1      8772  379703176 1168883
## + book_club_picks        1       717  379693687 1168884
## + poetry                 1       155  379694249 1168884
## - bestsellers            1     10379  379704783 1168884
## - lit_fiction            1     12804  379707208 1168885
## - ebb_preferences_count  1     35380  379729784 1168894
## - Opens                  1    381424  380075828 1169030
## - Month                 11  21715984  401410388 1177148
## - Year                   3  32994242  412688646 1181294
## - Lifetime.Message       1 125027291  504721695 1211299
## - activeduration         1 820653894 1200348298 1340410
## 
## Step:  AIC=1168880
## optoutduration ~ ebb_preferences_count + bestsellers + mysteries + 
##     science_fiction + lit_fiction + general_nonfiction + historical_fiction + 
##     romance + young_adult + bio_memoirs + lifestyle_cooking + 
##     childrens + history + Year + Opens + Lifetime.Message + activeduration + 
##     Month
## 
##                         Df Sum of Sq        RSS     AIC
## - science_fiction        1      1673  379697410 1168879
## - young_adult            1      1698  379697435 1168879
## - lifestyle_cooking      1      1937  379697674 1168879
## - history                1      2845  379698581 1168880
## - romance                1      3683  379699420 1168880
## - historical_fiction     1      4104  379699840 1168880
## - general_nonfiction     1      4992  379700729 1168880
## &lt;none&gt;                                379695737 1168880
## - mysteries              1      5575  379701311 1168881
## - childrens              1      6535  379702272 1168881
## - bio_memoirs            1      8747  379704483 1168882
## + Clicks                 1      1333  379694404 1168882
## + book_club_picks        1       698  379695039 1168882
## + poetry                 1       151  379695586 1168882
## - bestsellers            1     10284  379706020 1168883
## - lit_fiction            1     12733  379708470 1168883
## - ebb_preferences_count  1     35351  379731088 1168892
## - Opens                  1    385746  380081482 1169030
## - Month                 11  21720893  401416629 1177149
## - Year                   3  32996941  412692678 1181293
## - Lifetime.Message       1 125053753  504749489 1211305
## - activeduration         1 821182260 1200877997 1340474
## 
## Step:  AIC=1168879
## optoutduration ~ ebb_preferences_count + bestsellers + mysteries + 
##     lit_fiction + general_nonfiction + historical_fiction + romance + 
##     young_adult + bio_memoirs + lifestyle_cooking + childrens + 
##     history + Year + Opens + Lifetime.Message + activeduration + 
##     Month
## 
##                         Df Sum of Sq        RSS     AIC
## - young_adult            1       877  379698287 1168877
## - lifestyle_cooking      1      1790  379699200 1168878
## - history                1      3133  379700543 1168878
## - historical_fiction     1      3810  379701220 1168879
## - romance                1      3825  379701234 1168879
## - general_nonfiction     1      4868  379702278 1168879
## - mysteries              1      4877  379702287 1168879
## &lt;none&gt;                                379697410 1168879
## - childrens              1      7097  379704507 1168880
## + science_fiction        1      1673  379695737 1168880
## + Clicks                 1      1357  379696053 1168881
## + book_club_picks        1       676  379696734 1168881
## - bio_memoirs            1      9536  379706945 1168881
## - bestsellers            1      9814  379707223 1168881
## + poetry                 1        49  379697360 1168881
## - lit_fiction            1     12163  379709572 1168882
## - ebb_preferences_count  1     35733  379733142 1168891
## - Opens                  1    385690  380083100 1169028
## - Month                 11  21719244  401416654 1177147
## - Year                   3  33004634  412702044 1181295
## - Lifetime.Message       1 125052084  504749494 1211303
## - activeduration         1 821181679 1200879089 1340472
## 
## Step:  AIC=1168877
## optoutduration ~ ebb_preferences_count + bestsellers + mysteries + 
##     lit_fiction + general_nonfiction + historical_fiction + romance + 
##     bio_memoirs + lifestyle_cooking + childrens + history + Year + 
##     Opens + Lifetime.Message + activeduration + Month
## 
##                         Df Sum of Sq        RSS     AIC
## - lifestyle_cooking      1      1910  379700197 1168876
## - history                1      3048  379701335 1168877
## - romance                1      3312  379701599 1168877
## - historical_fiction     1      3837  379702124 1168877
## - mysteries              1      4945  379703232 1168877
## - general_nonfiction     1      4991  379703278 1168877
## &lt;none&gt;                                379698287 1168877
## - childrens              1      6316  379704603 1168878
## + Clicks                 1      1354  379696933 1168879
## - bio_memoirs            1      9312  379707599 1168879
## + young_adult            1       877  379697410 1168879
## + science_fiction        1       852  379697435 1168879
## + book_club_picks        1       747  379697540 1168879
## + poetry                 1       167  379698120 1168879
## - bestsellers            1     10711  379708998 1168880
## - lit_fiction            1     12772  379711059 1168880
## - ebb_preferences_count  1     34894  379733181 1168889
## - Opens                  1    385564  380083851 1169027
## - Month                 11  21731354  401429641 1177150
## - Year                   3  33004005  412702292 1181293
## - Lifetime.Message       1 125056947  504755234 1211303
## - activeduration         1 821186029 1200884316 1340471
## 
## Step:  AIC=1168876
## optoutduration ~ ebb_preferences_count + bestsellers + mysteries + 
##     lit_fiction + general_nonfiction + historical_fiction + romance + 
##     bio_memoirs + childrens + history + Year + Opens + Lifetime.Message + 
##     activeduration + Month
## 
##                         Df Sum of Sq        RSS     AIC
## - romance                1      2645  379702842 1168875
## - history                1      2749  379702946 1168875
## - historical_fiction     1      3790  379703987 1168876
## - childrens              1      5056  379705253 1168876
## &lt;none&gt;                                379700197 1168876
## - mysteries              1      5193  379705390 1168876
## - general_nonfiction     1      6142  379706339 1168877
## + lifestyle_cooking      1      1910  379698287 1168877
## + Clicks                 1      1373  379698824 1168878
## + young_adult            1       997  379699200 1168878
## + book_club_picks        1       892  379699305 1168878
## + science_fiction        1       715  379699482 1168878
## + poetry                 1       375  379699822 1168878
## - bio_memoirs            1     10043  379710240 1168878
## - bestsellers            1     11850  379712047 1168879
## - lit_fiction            1     13211  379713408 1168879
## - ebb_preferences_count  1     33915  379734112 1168888
## - Opens                  1    384949  380085146 1169025
## - Month                 11  21738685  401438882 1177151
## - Year                   3  33002100  412702297 1181291
## - Lifetime.Message       1 125068708  504768905 1211305
## - activeduration         1 821207051 1200907248 1340471
## 
## Step:  AIC=1168875
## optoutduration ~ ebb_preferences_count + bestsellers + mysteries + 
##     lit_fiction + general_nonfiction + historical_fiction + bio_memoirs + 
##     childrens + history + Year + Opens + Lifetime.Message + activeduration + 
##     Month
## 
##                         Df Sum of Sq        RSS     AIC
## - history                1      2387  379705230 1168874
## - historical_fiction     1      3416  379706259 1168875
## - mysteries              1      4416  379707258 1168875
## &lt;none&gt;                                379702842 1168875
## - general_nonfiction     1      5927  379708770 1168876
## - childrens              1      7365  379710208 1168876
## + romance                1      2645  379700197 1168876
## + Clicks                 1      1335  379701507 1168877
## + lifestyle_cooking      1      1243  379701599 1168877
## + science_fiction        1       986  379701856 1168877
## + book_club_picks        1       746  379702097 1168877
## + young_adult            1       467  379702376 1168877
## + poetry                 1       134  379702708 1168877
## - bio_memoirs            1     10138  379712981 1168877
## - bestsellers            1     10238  379713080 1168877
## - lit_fiction            1     12643  379715485 1168878
## - ebb_preferences_count  1     33888  379736731 1168887
## - Opens                  1    385925  380088767 1169025
## - Month                 11  21736204  401439047 1177149
## - Year                   3  33109236  412812078 1181328
## - Lifetime.Message       1 125068367  504771209 1211304
## - activeduration         1 821207584 1200910426 1340470
## 
## Step:  AIC=1168874
## optoutduration ~ ebb_preferences_count + bestsellers + mysteries + 
##     lit_fiction + general_nonfiction + historical_fiction + bio_memoirs + 
##     childrens + Year + Opens + Lifetime.Message + activeduration + 
##     Month
## 
##                         Df Sum of Sq        RSS     AIC
## - historical_fiction     1      1240  379706469 1168873
## - mysteries              1      4488  379709718 1168874
## - general_nonfiction     1      4714  379709944 1168874
## &lt;none&gt;                                379705230 1168874
## + history                1      2387  379702842 1168875
## + romance                1      2284  379702946 1168875
## - bio_memoirs            1      8471  379713701 1168876
## - childrens              1      8642  379713872 1168876
## + Clicks                 1      1352  379703878 1168876
## + science_fiction        1      1188  379704041 1168876
## + lifestyle_cooking      1      1058  379704171 1168876
## + book_club_picks        1       859  379704370 1168876
## + young_adult            1       433  379704796 1168876
## + poetry                 1        27  379705202 1168876
## - bestsellers            1     10751  379715980 1168876
## - lit_fiction            1     13527  379718757 1168878
## - ebb_preferences_count  1     36469  379741699 1168887
## - Opens                  1    386432  380091661 1169024
## - Month                 11  21735185  401440414 1177148
## - Year                   3  33137955  412843185 1181338
## - Lifetime.Message       1 125076099  504781329 1211305
## - activeduration         1 821224890 1200930119 1340470
## 
## Step:  AIC=1168873
## optoutduration ~ ebb_preferences_count + bestsellers + mysteries + 
##     lit_fiction + general_nonfiction + bio_memoirs + childrens + 
##     Year + Opens + Lifetime.Message + activeduration + Month
## 
##                         Df Sum of Sq        RSS     AIC
## - mysteries              1      4807  379711277 1168873
## &lt;none&gt;                                379706469 1168873
## - general_nonfiction     1      5488  379711958 1168873
## + romance                1      2211  379704258 1168874
## - childrens              1      8033  379714502 1168874
## + Clicks                 1      1329  379705141 1168874
## + historical_fiction     1      1240  379705230 1168874
## + lifestyle_cooking      1      1168  379705302 1168874
## + book_club_picks        1       983  379705486 1168874
## + science_fiction        1       860  379705609 1168874
## + young_adult            1       489  379705980 1168874
## + history                1       211  379706259 1168875
## + poetry                 1        68  379706402 1168875
## - bio_memoirs            1     10990  379717459 1168875
## - bestsellers            1     12063  379718533 1168875
## - lit_fiction            1     16365  379722834 1168877
## - ebb_preferences_count  1     37282  379743751 1168885
## - Opens                  1    386882  380093352 1169022
## - Month                 11  21737664  401444134 1177147
## - Year                   3  33137649  412844118 1181336
## - Lifetime.Message       1 125079282  504785752 1211304
## - activeduration         1 821227824 1200934293 1340469
## 
## Step:  AIC=1168873
## optoutduration ~ ebb_preferences_count + bestsellers + lit_fiction + 
##     general_nonfiction + bio_memoirs + childrens + Year + Opens + 
##     Lifetime.Message + activeduration + Month
## 
##                         Df Sum of Sq        RSS     AIC
## &lt;none&gt;                                379711277 1168873
## + mysteries              1      4807  379706469 1168873
## - general_nonfiction     1      5972  379717249 1168873
## + historical_fiction     1      1559  379709718 1168874
## - childrens              1      8659  379719936 1168874
## + romance                1      1471  379709806 1168874
## + lifestyle_cooking      1      1460  379709817 1168874
## + Clicks                 1      1300  379709977 1168874
## + book_club_picks        1      1155  379710122 1168874
## + young_adult            1       624  379710653 1168874
## + science_fiction        1       344  379710932 1168874
## + history                1       151  379711126 1168875
## + poetry                 1        39  379711238 1168875
## - bio_memoirs            1     11807  379723084 1168875
## - bestsellers            1     17750  379729027 1168878
## - lit_fiction            1     21837  379733114 1168879
## - ebb_preferences_count  1     41359  379752636 1168887
## - Opens                  1    386588  380097865 1169022
## - Month                 11  21735950  401447227 1177146
## - Year                   3  33241653  412952930 1181373
## - Lifetime.Message       1 125074520  504785796 1211302
## - activeduration         1 821274884 1200986161 1340473</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lm_fit)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = optoutduration ~ ebb_preferences_count + bestsellers + 
##     lit_fiction + general_nonfiction + bio_memoirs + childrens + 
##     Year + Opens + Lifetime.Message + activeduration + Month, 
##     data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -759.30  -15.55   -2.86    6.97  701.25 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           -1.584e+01  8.298e-01 -19.089  &lt; 2e-16 ***
## ebb_preferences_count  1.588e-01  3.941e-02   4.029 5.61e-05 ***
## bestsellers1          -1.231e+00  4.665e-01  -2.639  0.00831 ** 
## lit_fiction1          -1.273e+00  4.348e-01  -2.927  0.00342 ** 
## general_nonfiction1   -7.120e-01  4.651e-01  -1.531  0.12582    
## bio_memoirs1          -9.440e-01  4.385e-01  -2.152  0.03136 *  
## childrens1             7.233e-01  3.924e-01   1.843  0.06527 .  
## Year2015               5.148e+01  5.281e-01  97.495  &lt; 2e-16 ***
## Year2016               2.298e+01  5.821e-01  39.482  &lt; 2e-16 ***
## Year2017               1.586e+01  8.050e-01  19.703  &lt; 2e-16 ***
## Opens                 -1.116e-02  9.059e-04 -12.317  &lt; 2e-16 ***
## Lifetime.Message       2.245e-01  1.014e-03 221.542  &lt; 2e-16 ***
## activeduration         7.372e-01  1.298e-03 567.695  &lt; 2e-16 ***
## Month02               -2.809e+00  5.416e-01  -5.187 2.14e-07 ***
## Month03               -3.168e+00  6.068e-01  -5.220 1.79e-07 ***
## Month04               -4.857e+00  6.457e-01  -7.522 5.44e-14 ***
## Month05               -3.824e+00  7.474e-01  -5.116 3.12e-07 ***
## Month06               -7.232e-01  7.395e-01  -0.978  0.32808    
## Month07               -2.191e+01  6.668e-01 -32.862  &lt; 2e-16 ***
## Month08               -2.878e+01  6.098e-01 -47.187  &lt; 2e-16 ***
## Month09               -2.582e+01  6.014e-01 -42.929  &lt; 2e-16 ***
## Month10               -1.465e+00  6.620e-01  -2.213  0.02693 *  
## Month11                1.299e+01  6.781e-01  19.150  &lt; 2e-16 ***
## Month12                1.314e+01  6.411e-01  20.489  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 50.48 on 149003 degrees of freedom
## Multiple R-squared:  0.9471, Adjusted R-squared:  0.9471 
## F-statistic: 1.16e+05 on 23 and 149003 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Adjusted R-squared: 0.9471 which is really good, and nearly all our variables are significant</p>
<p>We will now apply the prediction model to the test data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">predictedvalues &lt;-<span class="st"> </span><span class="kw">predict</span>(lm_fit, <span class="dt">newdata =</span> test)</code></pre></div>
<p>Now, lets look at the first few values of prediction, and compare it to the values of optoutduration in the test data set</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(predictedvalues)</code></pre></div>
<pre><code>##        11        34        37        55        57        66 
## 462.27999 639.89648  52.19734  46.84039 618.88782  52.33014</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(test<span class="op">$</span>optoutduration)</code></pre></div>
<pre><code>## [1] 500.028148 568.744468  44.306655  17.186285 692.633565   3.806088</code></pre>
<p>This means that for the value of 500.028148, our prediction was 462.27999, for 568.744468, it was 639.89648, for 44.306655, it was 52.19734 and so on.</p>
<p>Baseline model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bestguess &lt;-<span class="st"> </span><span class="kw">median</span>(train<span class="op">$</span>optoutduration) </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RMSE.baseline &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">median</span>((bestguess <span class="op">-</span><span class="st"> </span>train<span class="op">$</span>optoutduration) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))
RMSE.baseline</code></pre></div>
<pre><code>## [1] 71.0263</code></pre>
<p>Evaluate the accuracy</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RMSE.predictedvalues &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>((predictedvalues <span class="op">-</span><span class="st"> </span>test<span class="op">$</span>optoutduration) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))
RMSE.predictedvalues</code></pre></div>
<pre><code>## [1] 52.59503</code></pre>
<p>Apparently our's is good model but can be a lot better</p>
<h5 id="decision-tree">Decision Tree</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Needed to grow a tree</span>
<span class="kw">library</span>(rpart)
<span class="co">#To draw a pretty tree </span>
<span class="kw">library</span>(rattle)</code></pre></div>
<pre><code>## Rattle: A free graphical interface for data science with R.
## Version 5.1.0 Copyright (c) 2006-2017 Togaware Pty Ltd.
## Type 'rattle()' to shake, rattle, and roll your data.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rt &lt;-<span class="st"> </span><span class="kw">rpart</span>(optoutduration <span class="op">~</span><span class="st"> </span>. , <span class="dt">data =</span> train[<span class="op">-</span><span class="dv">1</span>], <span class="dt">method =</span> <span class="st">&quot;anova&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Examine life_predicted_2</span>
<span class="kw">plot</span>(rt)
<span class="kw">text</span>(rt)</code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fancyRpartPlot</span>(rt) <span class="co"># This gives better plot</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">predicted_dt &lt;-<span class="st"> </span><span class="kw">predict</span>(rt,test)</code></pre></div>
<p>Now, lets look at the first few values of prediction, and compare it to the values of optoutduration in the test data set</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(predicted_dt)</code></pre></div>
<pre><code>##        11        34        37        55        57        66 
## 493.90983 636.44930  29.81074  29.81074 636.44930  29.81074</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(test<span class="op">$</span>optoutduration)</code></pre></div>
<pre><code>## [1] 500.028148 568.744468  44.306655  17.186285 692.633565   3.806088</code></pre>
<p>Evaluate the accuracy</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RMSE.predicted_dt &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>((predicted_dt <span class="op">-</span><span class="st"> </span>test<span class="op">$</span>optoutduration) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))
RMSE.predicted_dt</code></pre></div>
<pre><code>## [1] 64.94651</code></pre>
<h5 id="i-think-it-would-be-better-to-build-a-classification-model-by-classifying-optoutduration-variable-in-quarter-monthly-duration.">I think it would be better to build a classification model by classifying optoutduration variable in Quarter monthly duration.</h5>

</body>
</html>
